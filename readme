# KTXNN_INT3405E1 — MABe Mouse Behavior Detection

This repository contains the **team solution** for the Kaggle competition  
**MABe Challenge – Social Action Recognition in Mice**.

The project is developed as the **final course project for the Machine Learning course (INT3405E1)** at the **University of Engineering and Technology (UET), VNU Hanoi**.

---

## About the Competition

The **MABe (Multi-Agent Behavior) Challenge** focuses on recognizing and localizing mouse behaviors from **pose trajectories** rather than raw video.  
Each behavior is annotated as a **temporal interval**, making the task an event-detection problem instead of simple frame-level classification.

Key challenges of the competition include:
- Multi-animal interactions (up to four mice per video)
- Strong class imbalance, especially for rare social behaviors
- Large variability across laboratories (tracking setups, frame rates, noise)
- Strict evaluation constraints on valid behaviors and non-overlapping events

The goal is to predict valid behavior intervals that generalize well across laboratories.

---

## About This Project

This repository implements a complete end-to-end solution for the competition:
- Data exploration and analysis
- Preprocessing of pose-based tracking data
- Feature engineering for single-mouse and pairwise behaviors
- Model training using gradient boosting methods
- Ensemble inference and event-level post-processing

The implementation prioritizes **robustness, interpretability, and compliance with the official evaluation protocol**, making it suitable for both competition submission and academic reporting.

---

## Repository Structure
KTXNN_INT3405E1/
├── EDA/ # Exploratory data analysis
├── data_raw/ # Utilities for loading raw metadata, tracking, annotations
├── model_trials/ # Single-model baselines and experiments
├── ensemble/ # Ensemble models and post-processing pipeline
├── metric.py # Local evaluation / helper metric utilities
└── .gitignore

---

## Dataset

The project is designed to run in a **Kaggle Notebook environment** with the official dataset:
/kaggle/input/MABe-mouse-behavior-detection

Main data components:
- `train.csv`, `test.csv`
- `train_tracking/`, `test_tracking/` (pose trajectories in parquet format)
- `train_annotation/` (event-level behavior annotations)

---

## High-Level Method Summary

- Pose trajectories are transformed from long format to frame-level wide format
- Coordinates are normalized using physical scale information
- Behaviors are separated into:
  - **Single-mouse behaviors** (self-target)
  - **Pairwise social behaviors** (agent–target interactions)
- FPS-aware temporal features are extracted
- One binary classifier is trained per action using:
  - LightGBM
  - XGBoost
  - CatBoost
- Multiple models are combined via probability averaging
- Frame-level predictions are converted into valid event intervals using:
  temporal smoothing → action-wise thresholds → minimum duration → no-overlap constraint

---

## Academic Context

This work is submitted as the **final project** for:
- **Course:** Machine Learning (INT3405E1)  
- **Institution:** University of Engineering and Technology, VNU Hanoi  

The repository serves as both:
- a reproducible competition solution, and  
- an academic project demonstrating practical machine learning system design.

---

## Team Members

- **Nguyen Mai Thanh Thu**  
  University of Engineering and Technology, VNU Hanoi  
  Email: 23021731@vnu.edu.vn

- **Bui Thu Phuong**  
  University of Engineering and Technology, VNU Hanoi  
  Email: 23021667@vnu.edu.vn
